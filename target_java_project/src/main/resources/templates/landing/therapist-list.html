<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{landing/layout/main}">

<head>
    <title th:text="#{landing.therapist_list.title} + ' - GoodHelp'">Our Therapists - GoodHelp</title>
    <link rel="stylesheet" th:href="@{/css/landing/therapist-list.css}">
</head>

<body>
    <main layout:fragment="content">
        <section class="gh-therapist-list">
            <!-- Decorative soft light background -->
            <div class="gh-therapist-list__soft-light-container">
                <div class="gh-therapist-list__soft-light"></div>
            </div>

            <div class="gh-container">
                <!-- Page title -->
                <h1 class="gh-therapist-list__h1" th:text="#{our_specialists}">Our Specialists</h1>

                <!-- Therapist cards grid -->
                <div class="gh-therapist-list__list">
                    <div th:text="${therapistList.size()}"></div>
                    <th:block th:each="t : ${therapistList}">
                        <div th:replace="~{landing/fragments/therapist-card :: therapistCard(therapist=${t})}"></div>
                    </th:block>

                    <!-- Empty state when no therapists -->
                    <div th:if="${#lists.isEmpty(therapistList)}" class="gh-therapist-list__empty">
                        <p th:text="#{landing.therapist_list.empty}">No therapists found. Please try again later.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Google Analytics tracking script -->
        <script th:inline="javascript">
            window.addEventListener('DOMContentLoaded', function () {
                // Track clicks on "View Profile" buttons
                document.querySelectorAll('.view-specific-therapist-btn').forEach(function (btn) {
                    btn.addEventListener('click', function () {
                        if (typeof gtag !== 'undefined') {
                            gtag('event', 'view_specific_therapist_btn_clicked_on_select_therapist_page', {
                                'event_category': 'Conversions'
                            });
                        }
                    });
                });

                // Track view_item_list event for analytics
                var viewItemListData = [];
                /*[# th:each="therapist,iterStat : ${therapistList}"]*/
                viewItemListData.push({
                    'id': 'P' + /*[[${therapist.id()}]]*/ '0',
                    'name': /*[[${therapist.fullName()}]]*/ 'Therapist',
                    'list_name': 'Select Therapist - All Therapists List',
                    'category': 'All Therapists',
                    'list_position': /*[[${iterStat.index + 1}]]*/ 1,
                    'quantity': 1,
                    'price': /*[[${therapist.price()}]]*/ 0
                });
                /*[/]*/

                if (typeof gtag !== 'undefined' && viewItemListData.length > 0) {
                    gtag('event', 'view_item_list', {
                        'items': viewItemListData
                    });
                }
            });
        </script>
    </main>
</body>

</html>